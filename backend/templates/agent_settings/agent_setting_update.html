{% extends "knowledge/base.html" %}

{% block knowledge_content %}
<div class="max-w-3xl mx-auto py-20 px-12" x-data="{ 
    showActionModal: false,
    showDataSourceModal: false,
    selectedLang: 'curl',
    showKey: false,
    newKeyName: '',
    generatedKey: null,
    tools: [],
    advancedOpen: false
}">
    <div class="prose max-w-none">
        <div class="space-y-6">
            <h1 class="text-4xl font-bold mb-8">Agent Configuration</h1>

            <form method="POST">
                {% csrf_token %}
                
                <!-- Core LLM -->
                <div class="form-control">
                    <label class="label">
                        <span class="label-text font-bold">Core LLM</span>
                    </label>
                    <select name="core_llm" class="select select-bordered w-full">
                        <option value="gpt4">GPT-4</option>
                        <option value="gpt4-mini">GPT-4 mini</option>
                        <option value="claude-3-sonnet">Claude 3 Sonnet</option>
                        <option value="claude-3-haiku">Claude 3 Haiku</option>
                    </select>
                    <label class="label">
                        <span class="label-text-alt">
                            <strong>Choose the AI model that powers your answers and actions.</strong><br/>
                            This model will be the brain behind generating answers and deciding whether to use additional tools based on the context. Pick a model based on your needs: higher-performing models like GPT-4o are best for complex tasks, while lighter models like GPT-4o mini are faster and more cost-efficient.                        </span>
                    </label>
                </div>

                <!-- Advanced Settings -->
                <div class="bg-base-200 mt-6 rounded-lg">
                    <div class="h-9 px-4 flex items-center justify-between cursor-pointer"
                         @click="advancedOpen = !advancedOpen">
                        <span class="text-lg font-bold">Advanced</span>
                        <svg :class="{'rotate-180': advancedOpen}" class="w-6 h-6 transform transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </div>
                    <div x-show="advancedOpen" 
                         x-transition:enter="transition ease-out duration-200"
                         x-transition:enter-start="opacity-0 transform -translate-y-2"
                         x-transition:enter-end="opacity-100 transform translate-y-0"
                         x-transition:leave="transition ease-in duration-200"
                         x-transition:leave-start="opacity-100 transform translate-y-0"
                         x-transition:leave-end="opacity-0 transform -translate-y-2"
                         class="p-4 space-y-6">
                        <!-- Condense LLM -->
                        <div class="form-control">
                            <label class="label">
                                <span class="label-text font-bold">Condense LLM</span>
                            </label>
                            <select name="condense_llm" class="select select-bordered w-full">
                                <option value="gpt4o" {% if agent_setting.condense_llm == 'gpt4o' %}selected{% endif %}>GPT-4o</option>
                                <option value="gpt4o_mini" {% if agent_setting.condense_llm == 'gpt4o_mini' %}selected{% endif %}>GPT-4o mini</option>
                                <option value="o1" {% if agent_setting.condense_llm == 'o1' %}selected{% endif %}>o1</option>
                                <option value="o1_mini" {% if agent_setting.condense_llm == 'o1_mini' %}selected{% endif %}>o1 mini</option>
                                <option value="claude_3_5_sonnet" {% if agent_setting.condense_llm == 'claude_3_5_sonnet' %}selected{% endif %}>Claude 3.5 Sonnet</option>
                                <option value="claude_3_5_haiku" {% if agent_setting.condense_llm == 'claude_3_5_haiku' %}selected{% endif %}>Claude 3.5 Haiku</option>
                            </select>
                            <label class="label">
                                <span class="label-text-alt">
                                    <strong>Select the model to condense conversations and craft retrieval queries.</strong><br/>
                                    This model simplifies ongoing conversations into concise, context-rich questions that guide the retrieval process. Choose a model based on the complexity and performance you need: advanced models handle nuanced contexts better, while lighter models are faster and more efficient.
                                </span>
                            </label>
                        </div>

                        <!-- Embeddings -->
                        <div class="form-control">
                            <label class="label">
                                <span class="label-text font-bold">Embeddings</span>
                            </label>
                            <select name="embeddings" class="select select-bordered w-full">
                                <option value="ada002" {% if agent_setting.embeddings == 'ada002' %}selected{% endif %}>text-embedding-ada-002</option>
                                <option value="minilm" {% if agent_setting.embeddings == 'minilm' %}selected{% endif %}>all-MiniLM-L6-v2</option>
                                <option value="mpnet" {% if agent_setting.embeddings == 'mpnet' %}selected{% endif %}>all-mpnet-base-v2</option>
                                <option value="bger" {% if agent_setting.embeddings == 'bger' %}selected{% endif %}>bge-large-en</option>
                            </select>
                            <label class="label">
                                <span class="label-text-alt">
                                    <strong>Select the embedding model to convert text into numerical vectors for retrieval.</strong><br/>
                                    This model transforms text into numerical vectors, capturing semantic meaning for effective information retrieval. Choose a model that aligns with your performance and accuracy requirements.
                                    <br/><br/>
                                    ⚠️ Changing the embedding model will require the knowledge index to be recreated. This process may take some time depending on the size of your dataset.
                                </span>
                            </label>
                        </div>

                        <!-- Extensions -->
                        <div class="form-control">
                            <label class="label">
                                <span class="label-text font-bold">Extensions</span>
                            </label>
                            
                            <!-- Extension buttons -->
                            <div class="space-y-6">
                                <div class="flex gap-2">
                                    <button type="button"
                                            class="btn btn-outline btn-primary btn-sm"
                                            @click="showActionModal = true">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                                        </svg>
                                        Add Action
                                    </button>
                                    
                                    <button type="button"
                                            class="btn btn-outline btn-primary btn-sm"
                                            @click="showDataSourceModal = true">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                                        </svg>
                                        Add Data Source
                                    </button>
                                </div>

                                <!-- Tool list -->
                                <div class="space-y-6">
                                    <template x-for="(tool, index) in tools" :key="index">
                                        <div class="card bg-base-200 shadow-sm border border-base-300">
                                            <!-- Tool card content will be added later -->
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </div>

                        <!-- Switches -->
                        <div class="space-y-4">
                            <!-- Artificial Delay Switch -->
                            <div class="form-control">
                                <label class="label cursor-pointer">
                                    <span class="label-text">
                                        <div class="font-medium">Add artificial delay</div>
                                        <div class="text-sm text-base-content/70">
                                            Enable this option to add a natural typing delay to your agent's responses, creating a more human-like interaction experience.
                                        </div>
                                    </span>
                                    <input type="checkbox" 
                                           name="delay" 
                                           class="toggle toggle-primary" 
                                           {% if agent_setting.delay %}checked{% endif %} />
                                </label>
                            </div>

                            <!-- Hide Tool Usage Switch -->
                            <div class="form-control">
                                <label class="label cursor-pointer">
                                    <span class="label-text">
                                        <div class="font-medium">Hide tool usage messages</div>
                                        <div class="text-sm text-base-content/70">
                                            Enable this option to hide the default tool usage announcements, making conversations feel more natural by removing repetitive notifications when tools are being used.
                                        </div>
                                    </span>
                                    <input type="checkbox" 
                                           name="hide_tool_messages" 
                                           class="toggle toggle-primary" 
                                           {% if agent_setting.hide_tool_messages %}checked{% endif %} />
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Save Button -->
                <div class="mt-6">
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>

            <!-- Share Agent Section -->
            <h2 class="text-2xl font-semibold mt-8">Share Agent</h2>
            <!-- Add the share agent section -->

            <!-- API Integration Section -->
            <h2 class="text-2xl font-semibold mt-8">API Integration</h2>
            <!-- Add the API integration section -->
        </div>
    </div>
</div>
{% endblock %} 